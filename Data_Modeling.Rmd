---
title: "Modeling for Animal Shelter Data"
output: html_notebook
---
```{r}
#Load Libraries
library(tidyverse)
library(ggplot2)
library(DataExplorer)
library(caret)
library(gridExtra)
library(reshape)
library(purrr)
library(lubridate)
library(caret)
```
```{r}
cad_model <- read.csv("Data/Cleaned_Data_Frame.csv")
```
```{r}
glimpse(cad_model)
```

We will be modeling on OutcomeType variable
```{r data_split}
seed <- 333
inTraining <- createDataPartition(cad_model$OutcomeType, p=0.6, list=FALSE)
training.set <- cad_model[inTraining,]
Totalvalidation.set <- cad_model[-inTraining,]

# This will create another partition of the 40% of the data, so 20%-testing and 20%-validation

inValidation <- createDataPartition(Totalvalidation.set$OutcomeType, p=0.5, list=FALSE)
testing.set <- Totalvalidation.set[inValidation,]
validation.set <- Totalvalidation.set[-inValidation,]
```


```{r}
mod_fit_logistic <- train(OutcomeType ~ .,  
                 data=training.set,
                 method="glm", 
                 family="binomial",
                 tuneLength = 10)

pred_logistic <- predict(mod_fit_logistic, newdata=testing.set)

```
```{r}
confusionMatrix(table(data=pred_logistic, testing.set$OutcomeType))
```
