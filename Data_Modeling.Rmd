---
title: "Modeling for Animal Shelter Data"
output: html_notebook
---
```{r}
#Load Libraries
library(tidyverse)
library(ggplot2)
library(DataExplorer)
library(caret)
library(gridExtra)
library(reshape)
library(purrr)
library(lubridate)
library(caret)
```
```{r}
cad_model <- read.csv("Data/Cleaned_Data_Frame.csv")
cad_model <- cad_model %>%
            select(-DateTime, -MonthYear)  %>% 
       dummify(maxcat = 8L, select = c("S_Organ_Status_In", "Sex", "Name", "S_Organ_Status_Out", "AnimalType", "Intake.Type", "Intake.Condition"))
```
```{r}
glimpse(cad_model)
```

```{r}
#cad_model <- cad_model %>%
#            mutate(OutcomeType = ifelse(OutcomeType == "Adoption", 1, 0))
```
```{r}
#glimpse(cad_model)
```



We will be modeling on OutcomeType variable
```{r data_split}
seed <- 333
inTraining <- createDataPartition(cad_model$OutcomeType, p=0.6, list=FALSE)
training.set <- cad_model[inTraining,]
Totalvalidation.set <- cad_model[-inTraining,]

# This will create another partition of the 40% of the data, so 20%-testing and 20%-validation

inValidation <- createDataPartition(Totalvalidation.set$OutcomeType, p=0.5, list=FALSE)
testing.set <- Totalvalidation.set[inValidation,]
validation.set <- Totalvalidation.set[-inValidation,]
```


```{r}
mod_fit_logistic <- train(OutcomeType ~ .,  
                 data = training.set, 
                 method = "gbm", 
                 metric = "Accuracy",
                 preProcess = c("center", "scale"),
                 tuneLength = 10)

pred_logistic <- predict(mod_fit_logistic, newdata=testing.set)
confusionMatrix(table(data=pred_logistic, testing.set$OutcomeType))
```

